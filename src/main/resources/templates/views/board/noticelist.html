<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>공지사항</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Travelix Project">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="styles/bootstrap4/bootstrap.min.css">
<link href="plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.carousel.css">
<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
<link rel="stylesheet" type="text/css" href="plugins/OwlCarousel2-2.2.1/animate.css">
<link rel="stylesheet" type="text/css" href="../../styles/noticelist.css">
<link rel="stylesheet" type="text/css" href="../../styles/noticelist_responsive.css">


</head>

<body>
<div class="super-container">

<div th:replace="views/common/header"></div>
	<!-- Home -->

	<div class="home" style="margin-top:50px; color:black;" >
		<div class="home_content">
			<div class="maintitle"><h1>공지사항</h1></div>
			<p class="hellouser" th:if="${userName !=null}">
	<span id="userID" th:text="${userName}"></span>님 반갑습니다~!
	</p>
		<hr>
		<div class="search-area">
	<div class="search">
	<label for="sort">전 체 글</label>
	<form action="noticeSort" method="get">
		<select id="sort" name="noticeSortType" onchange="this.form.submit()">
			<option value="latest"th:selected="${map['noticeSortType'] =='lateset'}">최신순</option>
			<option value="reply" th:selected="${map['noticeSortType'] =='reply'}">댓글많은순</option>
			<option value="views" th:selected="${map['noticeSortType']=='views'}">조회수순</option>
		</select>
	</form>
	<div class="search-box">
		<form action="noticeListSearch" method="get">
	<input type="text" id="searchInput" name="noticeKeyword" placeholder="검색어입력">
	<button id="searchBtn" onclick="handleSearch()">🔍︎</button>
		</form>

</div>
</div>
</div>
<hr/>
		</div>
		
		
	</div>

	<!-- Intro -->

	<div class="intro" style="margin-top:0;padding-top:10px;">
			<div class="intro_content">
			 	<table>
			      <thead>
			        <tr>
			          <th>&nbsp;</th>
			          <th>글번호</th>
			          <th>제목</th>
			          <th>작성자</th>
			          <th>작성일</th>
			          <th>조회수</th>
			        </tr>
			      </thead>
			      <tbody>
			        <tr th:each="n:${noticelist}">
			          <td>[[${n.boardCategory == 1 ? '필독' : (n.boardCategory == 2 ? '공지' : ' ')}]]</td>
			          <td>[[${n.boardNo}]]</td>
			          <td>[[${n.boardTitle}]]</td>
			          <td th:text="${#strings.length(n.memName) > 1 ? #strings.substring(n.memName, 0, 1) + '**' : n.memName}"></td>
			          <td>[[${n.boardDate}]]</td>
			          <td>[[${n.boardReadCount}]]</td>
			          
			        </tr>
			      </tbody>
    			</table>	
			</div>
	</div>
	
	<div class="write-button" style="text-align:right;">
  <button th:if="${session.loginUser}"type="button" onclick="location.href='/board/noticewrite'">글 쓰 기</button>
  
  </div>
	<div class="listpage">
	<ul class="pagination">
		<li class="list" th:if="${pi.startPage>1}">
			<a class="page" th:href="@{${loc}(page=${pi.currentPage-10},noticeKeyword=${map['noticeKeyword']},noticeSortType=${map['noticeSortType']})}">
				<span>&laquo;</span>
			</a>
		</li>
		
		<li class="list" th:each="p:${#numbers.sequence(pi.startPage,pi.endPage)}"
						th:if="${p<=pi.maxPage}" th:class="${p==pi.currentPage} ?'list active':'list'">
			<a class="page" th:href="@{${loc}(page=${p},noticeKeyword=${map['noticeKeyword']},noticeSortType=${map['noticeSortType']})}">[[${p}]]</a>
			
		</li>
		<li class="list" th:if="${pi.endPage<pi.maxPage}">
			<a class="page" th:href="@{${loc}(page=${(pi.currentPage+10)>pi.maxPage ? pi.maxPage : pi.currentPage+10},noticeKeyword=${map['noticeKeyword']},noticeSortType=${map['noticeSortType']})}">
				<span>&raquo;</span>
			</a>
		</li>
	</ul>
	</div>

	
				
	<!-- Footer -->
	<div th:replace="views/common/footer"></div>
</div>

<script th:inline="javascript">
	function handleSearch() {
		const keyword = document.getElementById("searchInput").value.trim();
		if (keyword) {
			location.href = `/board/noticelist?keyword=${encodeURIComponent(keyword)}`;
		} else {
			alert("검색어를 입력하세요!");
		}
	}
	document.getElementById("searchInput").addEventListener("keydown", function(e) {
		if (e.key === "Enter") {
			e.preventDefault(); // 엔터 눌렀을 때 기본 submit 방지
			document.getElementById("searchBtn").click(); // 🔍 버튼 클릭과 동일하게 실행
		}
	});
	function whenRowClicked(){
			window.location.href="/board/noticemain";
	}
	window.onload=function(){
		const rows=document.querySelectorAll("table tbody tr");
		for(let i=0;i<rows.length;i++){
			rows[i].onclick=whenRowClicked;
			rows[i].style.cursor="pointer";
		}
	}
	
	
</script>


</body>

</html>